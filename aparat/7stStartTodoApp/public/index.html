<!DOCTYPE html>
<html>
    <head>
        <title>firs app</title>
        <link rel="stylesheet" href="libs/bootstrap/css/bootstrap.min.css">

    </head>
    <body>
        <div class="container">
            <header>
                <h1>This is Node.js TODO app</h1>
                <p>you can manage your daily tasks by this app</p>
            </header>
            <!-- create form -->
            <div class="row">
                <div class="col">
                    <!-- return false baraye inke be soorate single page kard konad-->
                    <form onsubmit="createTodo();return false;" autocomplete="off">
                    <div class="form-group">
                        <label for="newTODO">Add TODO</label>
                        <input type="text" class="form-control" id="new-todo" placeholder="what you are going to do?"></input>

                    </div>
                    <button class="btn btn-succes">Add</button>
                </form>
                </div>
            </div>
            <!-- data table -->
            <div class="row mt-5">
                <div class="col">
                    <table class="table table-striped" id="todo-table">
                        <tbody>
                          <tr v-for="todo in todos"> 
                            <td>{{todo.text}}</td>
                          </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
        <!-- scripts -->
        <script src="libs/jQuery/jquery-3.3.1.min.js"></script>
        <script src="libs/bootstrap/js/bootstrap.min.js"></script>
        <script src="libs/vue/vue.min.js"></script>

        <script>
            var model = new Vue({
                el:'#todo-table',
                data: {
                    todos: [{text: 'todo one'}]
                }
            })


            function createTodo() {
                var newTodo = $('#new-todo').val();
                // validation.

                if(!newTodo){
                    alert('you should enter a text a new todo');
                    return;
                }
                // add new todo to to todo list
                $.post('/todos', {text: newTodo}, function(data){

                    model.todos.push(data);
                }).fail(function(err) {
                    console.log(err);
                    alert('operation failed');
                })

                // clear new todo text box
                $('#new-todo').val('');
                
            }

            function getTodos() {
                $.get('/todos' , function(data) {
                    model.todos = data;
                })
            }
            getTodos();
        </script>
    </body>
</html>